#Set location where you want to store external credentials.
$credfolder = C:\ProgramData\PSCreds
#Find or create directory for credentials.
If(!(test-path $credfolder)) {
  New-Item -ItemType Directory -Force -Path $credfolder
}
#Find or capture credentials.
try {
  $Creds = Import-CliXml -Path "$credfolder\credentials.Cred"
} 
catch {
  $Creds = Get-Credential -Message 'Please Enter Username and Password'
  $Creds | Export-CliXml -Path "$credfolder\credentials.Cred"
}
#Set variables for credentials to be used later in script.
$User = $Creds.UserName
$Password = $Creds.GetNetworkCredential().Password
